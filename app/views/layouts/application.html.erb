<!DOCTYPE html>
<html>
<head>
  <title>LibraryApp</title>
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>

  <!-- Bootstrap CSS -->
  <%= stylesheet_link_tag "https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" %>

  <!-- Bootstrap Icons -->
  <%= stylesheet_link_tag "https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" %>

  <!-- Custom CSS for Flash Message -->
  <style>
    .flash-message {
      position: fixed;
      top: 60px;  /* Position below the navbar */
      left: 50%;
      transform: translateX(-50%);
      z-index: 1050; /* Ensure it's above other content */
      display: none;
      padding: 10px 20px;
      background-color: #f8d7da; /* Red for errors, adjust for other types */
      color: #721c24;
      border-radius: 5px;
      font-weight: bold;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: opacity 0.5s ease-out;
    }

    .flash-message.success {
      background-color: #d4edda;
      color: #155724;
    }

    .flash-message.info {
      background-color: #d1ecf1;
      color: #0c5460;
    }

    .flash-message.warning {
      background-color: #fff3cd;
      color: #856404;
    }
  </style>
</head>
<body>
  <!-- Navigation Bar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <!-- LibraryApp Logo & Name -->
      <div class="d-flex align-items-center">
        <%= link_to about_path, class: 'navbar-brand d-flex align-items-center fs-3 fw-bold text-light me-4' do %>
          <i class="bi bi-book-fill me-2" style="font-size: 1.8rem;"></i> LibraryApp
        <% end %>

        <!-- Navbar Toggler for Mobile -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      </div>

      <!-- Navbar Items (Aligned to the Left) -->
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-3">
          <!-- Dropdown for Authors -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle fs-5 fw-bold" href="#" id="navbarDropdownAuthors" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Authors
            </a>
            <ul class="dropdown-menu" aria-labelledby="navbarDropdownAuthors">
              <li><%= link_to 'Show All Authors', authors_path, class: 'dropdown-item' %></li>
              <li><%= link_to 'Create Author', new_author_path, class: 'dropdown-item' %></li>
            </ul>
          </li>

          <!-- Dropdown for Books -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle fs-5 fw-bold" href="#" id="navbarDropdownBooks" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Books
            </a>
            <ul class="dropdown-menu" aria-labelledby="navbarDropdownBooks">
              <li><%= link_to 'Show All Books', books_path, class: 'dropdown-item' %></li>
              <li><%= link_to 'Create Book', new_book_path, class: 'dropdown-item' %></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Flash Message Container -->
  <div id="flash-message" class="flash-message"></div>

  <div class="container mt-4">
    <%= yield %>
  </div>

  <%= javascript_include_tag "https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" %>

  <!-- JavaScript to Handle Flash Message -->
  <script>
    // Display flash message if there's any
    document.addEventListener('DOMContentLoaded', function() {
      <% if flash[:notice] %>
        const flashMessage = document.getElementById('flash-message');
        flashMessage.textContent = "<%= flash[:notice] %>";
        flashMessage.classList.add('success');  // Add a class for success style
        flashMessage.style.display = 'block';
        setTimeout(() => {
          flashMessage.style.opacity = 0;
          setTimeout(() => flashMessage.style.display = 'none', 500);
        }, 2000); // Hide after 2 seconds
      <% elsif flash[:alert] %>
        const flashMessage = document.getElementById('flash-message');
        flashMessage.textContent = "<%= flash[:alert] %>";
        flashMessage.classList.add('warning');  // Add a class for warning style
        flashMessage.style.display = 'block';
        setTimeout(() => {
          flashMessage.style.opacity = 0;
          setTimeout(() => flashMessage.style.display = 'none', 500);
        }, 2000); // Hide after 2 seconds
      <% end %>
    });
  </script>
</body>
</html>
